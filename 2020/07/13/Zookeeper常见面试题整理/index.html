
<!DOCTYPE html>
<html lang="en" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Zookeeper常见面试题整理 - Mr.ou`s Blog</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="1、Zookeeper是什么？Zookeeper是Apache的一个分布式服务框架，是Apache Hadoop的一个子项目，同时是一个为分布式应用提供了一致性服务的软件，主要是用来解决分布式应用中,"> 
    <meta name="author" content="Mr.ou"> 
    <link rel="alternative" href="atom.xml" title="Mr.ou`s Blog" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
    
<link rel="stylesheet" href="/css/diaspora.css">

	
<link rel="stylesheet" href="/css/iconfont/iconfont.css">

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
<meta name="generator" content="Hexo 5.1.1"></head>

<body class="loading">
    <span id="config-title" style="display:none">Mr.ou`s Blog</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://yoursite.com"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">Zookeeper常见面试题整理</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">Zookeeper常见面试题整理</h1>
        <div class="stuff">
            <span>七月 13, 2020</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/Zookeeper%E5%AD%A6%E4%B9%A0/" rel="tag">Zookeeper学习</a></li><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag">面试题</a></li></ul>


        </div>
        <div class="content markdown">
            <h1 id="1、Zookeeper是什么？"><a href="#1、Zookeeper是什么？" class="headerlink" title="1、Zookeeper是什么？"></a>1、Zookeeper是什么？</h1><p>Zookeeper是Apache的一个分布式服务框架，是Apache Hadoop的一个子项目，同时是一个为分布式应用提供了一致性服务的软件，主要是用来解决分布式应用中经常遇到的一些数据管理问题，所提供的功能包括：统一命名服务、状态同步服务、集群管理、分布式应用配置项的管理等。</p>
<p>简单来说，<strong>zookeeper=文件系统+通知机制</strong></p>
<h1 id="2、介绍一下Zookeeper的存储结构？"><a href="#2、介绍一下Zookeeper的存储结构？" class="headerlink" title="2、介绍一下Zookeeper的存储结构？"></a>2、介绍一下Zookeeper的存储结构？</h1><p><img src="https://img-blog.csdnimg.cn/20200716231003637.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI0NjIxNQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 如上图所示，Zookeeper的底层是树形的数据结构来做存储的，它的每一个节点被称为Znode，在Zookeeper中znode是一个和Unix文件系统路径相似的节点，可以向节点中存储数据或者是获取数据。<br>Zookeeper为了保证高吞吐和低延迟，在内存中维持了树状的的结构，但是这样的结构也让Zookeeper不能用于存放大量的数据，默认的每个Znode节点的数据存放上限为1MB。</p>
<h1 id="3、Zookeeper的文件系统"><a href="#3、Zookeeper的文件系统" class="headerlink" title="3、Zookeeper的文件系统"></a>3、Zookeeper的文件系统</h1><p>Zookeeper的内部提供了一种多层级的节点命名空间，同时节点被称为Znode，和文件系统不一样的是，文件系统不能像Znode那样可以设置关联的数据，它只有文件节点可以存放数据，而目录节点不可以。</p>
<p><strong>需要注意的是：Zookeeper的每个Znode最多只能存放1MB的数据。</strong></p>
<h1 id="4、介绍一下Zookeeper四种类型的数据节点Znode。"><a href="#4、介绍一下Zookeeper四种类型的数据节点Znode。" class="headerlink" title="4、介绍一下Zookeeper四种类型的数据节点Znode。"></a>4、介绍一下Zookeeper四种类型的数据节点Znode。</h1><p>Zookeeper有四种类型的节点，分别是：持久化顺序节点(PERSISTENT)、持久化顺序编号目录节点(PERSISTENT_SEQUENTIAL)、临时目录节点(EPHEMERAL)、临时顺序编号目录节点(EPHEMERAL_SEQUENTIAL)。<br><strong>（1）持久化顺序节点(PERSISTENT)</strong><br>            该节点创建之后，当客户端和Zookeeper断开连接后，该节点依然存在，除非手动删除。<br><strong>（2）持久化顺序编号目录节点(PERSISTENT_SEQUENTIAL)</strong><br>            该节点创建时，Zookeeper会给该节点名称添加一个顺序编号，当客户端和Zookeeper断开连接后，该节点依然存在。<br><strong>（3）临时目录节点(EPHEMERAL)</strong><br>            该节点创建之后，当客户端和Zookeeper断开连接后，该节点就会被删除。<br><strong>（4）临时顺序编号目录节点(EPHEMERAL_SEQUENTIAL)</strong><br>            该节点创建时，Zookeeper会给该节点名称添加一个顺序编号，当客户端和Zookeeper断开连接后，该节点就会被删除掉。</p>
<h1 id="5、说一下Zookeeper常用的命令（详解）"><a href="#5、说一下Zookeeper常用的命令（详解）" class="headerlink" title="5、说一下Zookeeper常用的命令（详解）"></a>5、说一下Zookeeper常用的命令（详解）</h1><p><strong>Zookeeper常用的命令有：ls、create、get、set、delete</strong><br><strong>（1）ls命令</strong><br>基本格式为： ls  /path<br>使用ls命令查看zookeeper节点中的内容，在zookeeper控制客户端中，没有默认列表功能，必须要指定列表资源的位置。比如说：ls  /   或者  ls  /path<br>如下图所示：<br><img src="https://img-blog.csdnimg.cn/20200716234130455.png" alt="在这里插入图片描述"><br>这其实和linux操作系统中查看文件内容是类似的。</p>
<p><strong>（2）create命令</strong><br>基本格式为：create [-e] [-s] /path [data]<br>使用create命令创建一个新的znode，create [-e] [-s] path data - 创建节点，同时我们可以根据后面的参数创建不同类型的节点。<br>A、创建持久化目录节点时不需要给定后面任何参数，create /path  [data]<br>比如：create /test 123   ，其意思就是创建了一个持久化目录节点test，节点携带的信息为123，该节点创建后会一直存在，除非手动删除。</p>
<p>B、创建持久化顺序目录节点时，后面需要给定参数-s，create -s /path [data]<br>比如：create -s /test 456  ，该节点创建后会一直存在，除非手动删除。</p>
<p>C、创建临时目录节点时，后面需要给定参数-e，create -e /path [data]<br>比如：create -e /ssm 666 ，临时节点只在当前会话生命周期中有效，会话结束节点自动删除。</p>
<p>D、创建临时顺序目录节点时，后面需要给定l两个参数-e  -s ,create -e -s /path [data]。临时节点只在当前会话生命周期中有效，会话结束节点自动删除。</p>
<p><strong>（3）get命令</strong><br>基本格式为：get [-s] /path<br>get命令获取Znode中的数据，如下所示：<br><img src="https://img-blog.csdnimg.cn/20200717000307337.png" alt="在这里插入图片描述">同时，如果给定参数-s的话就会查看出Znode全部的信息。<br><img src="https://img-blog.csdnimg.cn/20200717000044872.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI0NjIxNQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>oldlu:存放的数据<br>cZxid:创建时 zxid(znode 每次改变时递增的事务 id)<br>ctime:创建时间戳<br>mZxid:最近一次更近的 zxid<br>mtime:最近一次更新的时间戳<br>pZxid:子节点的 zxid<br>cversion:子节点更新次数<br>dataversion:节点数据更新次数<br>aclVersion:节点 ACL(授权信息)的更新次数<br>ephemeralOwner:如果该节点为 ephemeral 节点(临时，生命周期与 session 一样),<br>ephemeralOwner 值表示与该节点绑定的 session id. 如果该节点不是<br>ephemeral 节点, ephemeralOwner 值为 0.<br>dataLength:节点数据字节数<br>numChildren:子节点数量</p>
<p><strong>（4）set命令</strong><br>基本格式为：set /path [data]<br>功能为添加或修改 Znode 中的值。<br><img src="https://img-blog.csdnimg.cn/20200717000409240.png" alt="在这里插入图片描述"><br><strong>（5）delete命令</strong><br>基本格式为：delete /path<br>功能为删除 Znode。<br><img src="https://img-blog.csdnimg.cn/20200717000456541.png" alt="在这里插入图片描述"></p>
<h1 id="6、介绍一下Zookeeper的监听机制？"><a href="#6、介绍一下Zookeeper的监听机制？" class="headerlink" title="6、介绍一下Zookeeper的监听机制？"></a>6、介绍一下Zookeeper的监听机制？</h1><p>Zookeeper的监听机制使用的是观察者模式来进行设计的。当客户端注册监听它关心的目录节点(znode)时，当目录节点（znode）发生变化时(数据变化、被删除、子目录节点增加或者删除)时，Zookeeper会通知客户端。但是watcher通知客户端时，只告诉客户端发生了事件而不会告知其内容，并且无论是客户端还是服务端，一旦一个监听器watcher被触发就会被zookeeper从相应的存储中删除，</p>
<h1 id="7、Zookeeper哪些部署模式？"><a href="#7、Zookeeper哪些部署模式？" class="headerlink" title="7、Zookeeper哪些部署模式？"></a>7、Zookeeper哪些部署模式？</h1><p>Zookeeper有三种部署模式：<br>（1）单机部署：一台集群上运行；<br>（2）集群部署：多台集群上运行；<br>（3）伪集群部署：一台集群上启动多个Zookeeper实例运行。</p>
<h1 id="8、Zookeeper中的服务器角色"><a href="#8、Zookeeper中的服务器角色" class="headerlink" title="8、Zookeeper中的服务器角色"></a>8、Zookeeper中的服务器角色</h1><p><strong>（1）Leader 领导者</strong><br>它是事务请求的唯一调度和处理者，保证集群事务处理的顺序性，同时也是集群内部各服务的调度者。</p>
<p><strong>（2）Follower跟随者</strong><br>主要是处理客户端的非事务请求，转发事务请求给 Leader 服务器，同时参与事务请求 Proposal 的投票，还有参与 Leader 选举投票。</p>
<p><strong>（3）Observer观察者</strong><br>它是3.0 版本以后引入的一个服务器角色，有在不影响集群事务处理能力的基础上提升集群的非事务处理能力，可以处理客户端的非事务请求，转发事务请求给 Leader 服务器，但是它不参与任何形式的投票</p>
<h1 id="9、zookeeper-怎么保证主从节点的状态同步"><a href="#9、zookeeper-怎么保证主从节点的状态同步" class="headerlink" title="9、zookeeper 怎么保证主从节点的状态同步"></a>9、zookeeper 怎么保证主从节点的状态同步</h1><p>zookeeper 的核心是原子广播机制，这个机制保证了各个 server 之间的同步。实现这个机制的协议叫做 zab 协议。 zab 协议有两种模式，分别是恢复模式（选主）和广播模式（同步）。当服务启动或者在领导者(Leader)崩溃后，zab 就进入了恢复模式，当领导者(Leader)被选举出来，且大多数 server 完成了和 leader 的状态同步以后，恢复模式就结束了。状态同步保证了 leader 和 server 具有相同的系统状态。</p>
<h1 id="10、集群中为什么要有主节点（master）？"><a href="#10、集群中为什么要有主节点（master）？" class="headerlink" title="10、集群中为什么要有主节点（master）？"></a>10、集群中为什么要有主节点（master）？</h1><p>在分布式环境中，有些业务逻辑只需要集群中的某一台机器进行执行，而其他的机器可以共享这个结果，这样就可以大大减少了重复计算，从而提高性能，因此就需要有主节点。</p>
<h1 id="11、集群中有三台服务器，假如其中一个节点宕机了，这个时候的zookeeper还能继续使用吗？"><a href="#11、集群中有三台服务器，假如其中一个节点宕机了，这个时候的zookeeper还能继续使用吗？" class="headerlink" title="11、集群中有三台服务器，假如其中一个节点宕机了，这个时候的zookeeper还能继续使用吗？"></a>11、集群中有三台服务器，假如其中一个节点宕机了，这个时候的zookeeper还能继续使用吗？</h1><p>可以继续使用，Zookeeper本身也是集群，推荐的是配置不少于3台服务器，也就是说Zookeeper自身也要保证当其中一个节点宕机之后其他的节点也能正常的提供服务。Zookeeper的集群机制就是只要超过半数的节点正常，zookeeper就会正常的提供服务，只有当zookeeper节点宕（dang）得太多了，能工作的节点只剩下一半或者是不到一半的时候，集群才会失效。<br>比如说：3个节点的集群最多只能挂掉一个节点，2个节点的集群就不能挂掉任何一个节点。</p>
<h1 id="12、集群最少要几台机器？集群规则是怎样的？集群中有3台服务器，其中有一个节点宕机，这个时候Zookeeper还可以使用吗？"><a href="#12、集群最少要几台机器？集群规则是怎样的？集群中有3台服务器，其中有一个节点宕机，这个时候Zookeeper还可以使用吗？" class="headerlink" title="12、集群最少要几台机器？集群规则是怎样的？集群中有3台服务器，其中有一个节点宕机，这个时候Zookeeper还可以使用吗？"></a>12、集群最少要几台机器？集群规则是怎样的？集群中有3台服务器，其中有一个节点宕机，这个时候Zookeeper还可以使用吗？</h1><p> 集群规则为<strong>2N+1</strong>台，即最少需要3台机器。<br> 可以继续使用，单数服务器只要没超过一半多点服务器宕机就可以继续使用。</p>
<h1 id="13、说一下Zookeeper的应用场景。"><a href="#13、说一下Zookeeper的应用场景。" class="headerlink" title="13、说一下Zookeeper的应用场景。"></a>13、说一下Zookeeper的应用场景。</h1><p>zookeeper是一个经典的发布/订阅模式的分布式服务框架，开发人员经常使用它来进行一些分布式数据的发布/订阅（注册中心），一般有以下几个应用场景：<br>（1）数据发布/订阅；<br>（2）统一命名服务；<br>（3）分布式协调/通知；<br>（4）集群管理；<br>（5）负载均衡；<br>（6）分布式锁；<br>（7）分布式队列</p>
<p>返回首页：<a target="_blank" rel="noopener" href="https://oldou.github.io/">点击此处</a></p>
<p><strong>本文全属查阅资料以及平时自己笔记整理所写（不喜勿喷！），如有不正确的地方，请在评论区说明，我会及时进行更正。</strong></p>
<p><strong>现在暂时内容有些少，后面会持续更新……….</strong></p>
<p><strong>互相学习，互相进步！</strong></p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title='0' data-url='http://link.hhtjim.com/163/425570952.mp3'></li>
                        
                    
                        
                            <li title='1' data-url='http://link.hhtjim.com/163/425570952.mp3'></li>
                        
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
		data-enable='false'
        data-ae='false'
        data-ci=''
        data-cs=''
        data-r=''
        data-o=''
        data-a=''
        data-d='false'
    >查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
